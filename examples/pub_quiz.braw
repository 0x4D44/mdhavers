# pub_quiz.braw - A Scottish Pub Quiz game
# "Test yer knowledge at the local!"

fetch "lib/scots_lang"
fetch "lib/colors"

blether ""
blether green("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
blether green("    THE WEE SCOTTISH PUB QUIZ")
blether green("    'Test yer brains, win bragging rights!'")
blether green("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
blether ""

# ===============================================================
# Quiz Data
# ===============================================================

ken questions = [
    {
        "question": "Whit's the capital o' Scotland?",
        "options": ["Glasgow", "Edinburgh", "Aberdeen", "Dundee"],
        "answer": 2,
        "fact": "Edinburgh's been the capital since the 15th century!"
    },
    {
        "question": "Whit's Scotland's national animal?",
        "options": ["Haggis", "Unicorn", "Red Deer", "Highland Cow"],
        "answer": 2,
        "fact": "The unicorn represents purity, innocence, an' power!"
    },
    {
        "question": "Whit does 'braw' mean?",
        "options": ["Terrible", "Great/Fine", "Cold", "Hungry"],
        "answer": 2,
        "fact": "It's one o' the maist common Scots words ye'll hear!"
    },
    {
        "question": "Whit year did Scotland an' England unite?",
        "options": ["1603", "1707", "1745", "1820"],
        "answer": 2,
        "fact": "The Acts of Union merged the parliaments o' baith nations."
    },
    {
        "question": "Whit's a 'bairn' in Scots?",
        "options": ["A barn", "A child", "A drink", "A dance"],
        "answer": 2,
        "fact": "Ye'll hear 'wean' in Glasgow, but bairn works everywhere!"
    },
    {
        "question": "Whit's Scotland's largest loch by volume?",
        "options": ["Loch Ness", "Loch Lomond", "Loch Morar", "Loch Tay"],
        "answer": 1,
        "fact": "Loch Ness holds mair fresh water than aw the lakes in England!"
    },
    {
        "question": "Whit's haggis traditionally served wi'?",
        "options": ["Chips", "Neeps an' tatties", "Rice", "Pasta"],
        "answer": 2,
        "fact": "Neeps are turnips an' tatties are potatoes!"
    },
    {
        "question": "Wha wrote 'Auld Lang Syne'?",
        "options": ["Robert Burns", "Walter Scott", "Robert Louis Stevenson", "John Knox"],
        "answer": 1,
        "fact": "Burns Night is celebrated on January 25th!"
    },
    {
        "question": "Whit's the Scots word fer 'church'?",
        "options": ["Hoose", "Kirk", "Burn", "Ben"],
        "answer": 2,
        "fact": "Ye'll see 'kirk' in many Scottish place names!"
    },
    {
        "question": "Whit island chain is tae the north o' Scotland?",
        "options": ["Hebrides", "Orkney", "Shetland", "Faroe"],
        "answer": 3,
        "fact": "Shetland is closer tae Norway than tae Edinburgh!"
    }
]

# ===============================================================
# Game State
# ===============================================================

ken score = 0
ken total_questions = len(questions)
ken current_question = 0

# ===============================================================
# Game Functions
# ===============================================================

dae show_question(q) {
    blether ""
    blether yellow(f"Question {current_question + 1} o' {total_questions}")
    blether ""
    blether bold(q["question"])
    blether ""

    fer i in 0..len(q["options"]) {
        blether f"  {i + 1}. {q['options'][i]}"
    }
    blether ""
}

dae get_answer() {
    ken answer = speir("Yer answer (1-4): ")
    ken num = tae_int(wheesht(answer))
    gin num < 1 or num > 4 {
        blether red("That's no' a valid choice! Pick 1-4.")
        gie get_answer()
    }
    gie num
}

dae check_answer(q, player_answer) {
    gin player_answer == q["answer"] {
        blether ""
        blether green("âœ“ Spot on! That's richt!")
        blether cyan(f"  Fun fact: {q['fact']}")
        gie aye
    }
    blether ""
    blether red(f"âœ— Och naw! The answer wis: {q['options'][q['answer'] - 1]}")
    blether cyan(f"  Fun fact: {q['fact']}")
    gie nae
}

dae show_final_score() {
    blether ""
    blether "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    blether bold("    FINAL SCORE")
    blether "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    blether ""

    ken percentage = (score * 100) / total_questions

    blether f"Ye scored: {score} oot o' {total_questions} ({percentage}%)"
    blether ""

    gin percentage >= 80 {
        blether green("ğŸ† Pure brilliant! Ye're a proper Scottish expert!")
        blether random_proverb()
    } ither gin percentage >= 60 {
        blether yellow("ğŸ‘ No' bad at aw! Ye ken yer Scotland!")
    } ither gin percentage >= 40 {
        blether cyan("ğŸ“š Room fer improvement - time tae visit Scotland!")
    } ither {
        blether red("ğŸ˜… Och, never mind! Here's some Scottish wisdom:")
        blether f"   '{random_proverb()}'"
    }

    blether ""
}

# ===============================================================
# Main Game Loop
# ===============================================================

blether "Welcome tae the quiz! Answer each question by typin' 1, 2, 3, or 4."
blether f"There are {total_questions} questions. Guid luck!"

# Shuffle questions (simple shuffle using random selection)
ken shuffled = []
ken remaining = questions + []  # copy
fer i in 0..len(questions) {
    ken picked = dram(remaining)
    shove(shuffled, picked)
    # Remove picked from remaining (manual since no delete)
    ken new_remaining = []
    ken found = nae
    fer item in remaining {
        gin item == picked an nae found {
            found = aye
        } ither {
            shove(new_remaining, item)
        }
    }
    remaining = new_remaining
}

fer q in shuffled {
    show_question(q)
    ken answer = get_answer()

    gin check_answer(q, answer) {
        score = score + 1
    }

    current_question = current_question + 1

    gin current_question < total_questions {
        blether ""
        blether "---"
    }
}

show_final_score()

blether ""
blether random_farewell()
blether ""
